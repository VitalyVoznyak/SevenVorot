!function(t){"use strict";if(!BX.PopupWindowManager){BX.PopupWindowManager={_popups:[],_currentPopup:null,create:function(t,e,i){var n=t;if(BX.type.isPlainObject(t)&&!e&&!i&&(n=t.id,!BX.type.isNotEmptyString(n)))throw new Error("BX.PopupWindowManager: 'id' parameter is required.");var o=this.getPopupById(n);return null===o&&(o=new BX.PopupWindow(t,e,i),BX.addCustomEvent(o,"onPopupShow",BX.delegate(this.onPopupShow,this)),BX.addCustomEvent(o,"onPopupClose",BX.delegate(this.onPopupClose,this))),o},onPopupWindowIsInitialized:function(t,e){BX.addCustomEvent(e,"onPopupDestroy",BX.delegate(this.onPopupDestroy,this)),this._popups.push(e)},onPopupShow:function(t){null!==this._currentPopup&&this._currentPopup.close(),this._currentPopup=t},onPopupClose:function(t){this._currentPopup=null},onPopupDestroy:function(t){var e;-1!==(e=this._getPopupIndex(t.uniquePopupId))&&(this._popups=BX.util.deleteFromArray(this._popups,e))},getCurrentPopup:function(){return this._currentPopup},isPopupExists:function(t){return-1!==this._getPopupIndex(t)},isAnyPopupShown:function(){for(var t=0,e=this._popups.length;t<e;t++)if(this._popups[t].isShown())return!0;return!1},getPopupById:function(t){for(var e=0;e<this._popups.length;e++)if(this._popups[e].getId()===t)return this._popups[e];return null},_getPopupIndex:function(t){for(var e=0;e<this._popups.length;e++)if(this._popups[e].uniquePopupId===t)return e;return-1},getMaxZIndex:function(){var t,e=0;for(t=0;t<this._popups.length;t++)e=Math.max(e,this._popups[t].params.zIndex);return e}},BX.addCustomEvent("onPopupWindowIsInitialized",BX.proxy(BX.PopupWindowManager.onPopupWindowIsInitialized,BX.PopupWindowManager)),BX.PopupWindow=function(e,i,n){if(this.compatibleMode=!n||!BX.type.isBoolean(n.compatibleMode)||n.compatibleMode,!BX.type.isPlainObject(e)||i||n||(e=(n=e).id,i=n.bindElement,this.compatibleMode=!1),n=n||{},this.params=n,BX.type.isNotEmptyString(e)||(e="popup-window-"+BX.util.getRandomString().toLowerCase()),BX.onCustomEvent("onPopupWindowInit",[e,i,n]),this.uniquePopupId=e,this.params.zIndex=BX.type.isNumber(n.zIndex)?parseInt(n.zIndex):0,this.params.zIndexAbsolute=BX.type.isNumber(n.zIndexAbsolute)?parseInt(n.zIndexAbsolute):0,this.buttons=n.buttons&&BX.type.isArray(n.buttons)?n.buttons:[],this.offsetTop=BX.PopupWindow.getOption("offsetTop"),this.offsetLeft=BX.PopupWindow.getOption("offsetLeft"),this.firstShow=!1,this.bordersWidth=20,this.bindElementPos=null,this.closeIcon=null,this.resizeIcon=null,this.angle=null,this.overlay=null,this.titleBar=null,this.bindOptions="object"==typeof n.bindOptions?n.bindOptions:{},this.autoHide=!0===n.autoHide,this.autoHideHandler=BX.type.isFunction(n.autoHideHandler)?n.autoHideHandler:null,this.handleAutoHide=this.handleAutoHide.bind(this),this.handleOverlayClick=this.handleOverlayClick.bind(this),this.isAutoHideBinded=!1,this.closeByEsc=!0===n.closeByEsc,this.isCloseByEscBinded=!1,this.cacheable=!0,this.destroyed=!1,this.width=null,this.height=null,this.minWidth=null,this.minHeight=null,this.maxWidth=null,this.maxHeight=null,this.padding=null,this.contentPadding=null,this.background=null,this.contentBackground=null,this.appendContainer=document.body,this.dragOptions={cursor:"",callback:BX.DoNothing,eventName:""},this.dragged=!1,this.dragPageX=0,this.dragPageY=0,this.animationShowClassName=null,this.animationCloseClassName=null,this.animationCloseEventType=null,this.handleDocumentKeyUp=this.handleDocumentKeyUp.bind(this),this.handleResizeWindow=this.handleResizeWindow.bind(this),n.events)for(var o in n.events)BX.addCustomEvent(this,o,n.events[o]);var s="popup-window";n.contentColor&&BX.type.isNotEmptyString(n.contentColor)&&(s+=" popup-window-content-"+n.contentColor),n.titleBar&&(s+=" popup-window-with-titlebar"),n.className&&BX.type.isNotEmptyString(n.className)&&(s+=" "+n.className),n.darkMode&&(s+=" popup-window-dark"),this.popupContainer=document.createElement("div");var p="popup-window-titlebar-"+e;n.titleBar&&(this.titleBar=BX.create("div",{props:{className:"popup-window-titlebar",id:p}})),n.closeIcon&&(this.closeIcon=BX.create("span",{props:{className:"popup-window-close-icon"+(n.titleBar?" popup-window-titlebar-close-icon":"")},style:"object"==typeof n.closeIcon?n.closeIcon:{},events:{click:BX.proxy(this.handleCloseIconClick,this)}}),BX.browser.IsIE()&&BX.adjust(this.closeIcon,{attrs:{hidefocus:"true"}})),this.contentContainer=BX.create("div",{props:{id:"popup-window-content-"+e,className:"popup-window-content"}}),BX.adjust(this.popupContainer,{props:{id:e,className:s},style:{zIndex:this.getZindex(),position:"absolute",display:"none",top:"0px",left:"0px"},children:[this.titleBar,this.contentContainer,this.closeIcon]}),this.appendContainer.appendChild(this.popupContainer),this.buttonsContainer=null,n.angle&&this.setAngle(n.angle),n.overlay&&this.setOverlay(n.overlay),this.setOffset(n),this.setBindElement(i),this.setTitleBar(n.titleBar),this.setContent(n.content),this.setButtons(n.buttons),this.setWidth(n.width),this.setHeight(n.height),this.setMinWidth(n.minWidth),this.setMinHeight(n.minHeight),this.setMaxWidth(n.maxWidth),this.setMaxHeight(n.maxHeight),this.setResizeMode(n.resizable),this.setPadding(n.padding),this.setContentPadding(n.contentPadding),this.setBackground(n.background),this.setContentBackground(n.contentBackground),this.setAnimation(n.animation),this.setCacheable(n.cacheable),n.contentNoPaddings&&this.setContentPadding(0),n.noAllPaddings&&(this.setPadding(0),this.setContentPadding(0)),!1!==n.bindOnResize&&BX.bind(t,"resize",this.handleResizeWindow),BX.onCustomEvent("onPopupWindowIsInitialized",[e,this])},BX.PopupWindow.prototype.getId=function(){return this.uniquePopupId},BX.PopupWindow.prototype.isCompatibleMode=function(){return this.compatibleMode},BX.PopupWindow.prototype.setContent=function(t){if(this.contentContainer&&t)if(BX.type.isElementNode(t)){BX.cleanNode(this.contentContainer);var e=BX.type.isDomNode(t.parentNode);this.contentContainer.appendChild(t),(this.isCompatibleMode()||e)&&(t.style.display="block")}else BX.type.isString(t)?this.contentContainer.innerHTML=t:this.contentContainer.innerHTML="&nbsp;"},BX.PopupWindow.prototype.setButtons=function(t){if(this.buttons=t&&BX.type.isArray(t)?t:[],this.buttonsContainer&&BX.remove(this.buttonsContainer),this.buttons.length>0&&this.contentContainer){for(var e=[],i=0;i<this.buttons.length;i++){var n=this.buttons[i];n instanceof BX.PopupWindowButton?(n.popupWindow=this,e.push(n.render())):n instanceof BX.UI.Button&&(n.setContext(this),e.push(n.render()))}this.buttonsContainer=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-buttons"},children:e}))}},BX.PopupWindow.prototype.getButtons=function(){return this.buttons},BX.PopupWindow.prototype.getButton=function(t){for(var e=0;e<this.buttons.length;e++){var i=this.buttons[e];if(i.getId()===t)return i}return null},BX.PopupWindow.prototype.setBindElement=function(t){t&&"object"==typeof t&&(BX.type.isDomNode(t)||BX.type.isNumber(t.top)&&BX.type.isNumber(t.left)?this.bindElement=t:BX.type.isNumber(t.clientX)&&BX.type.isNumber(t.clientY)&&(BX.fixEventPageXY(t),this.bindElement={left:t.pageX,top:t.pageY,bottom:t.pageY}))},BX.PopupWindow.prototype.getBindElementPos=function(t){if(BX.type.isDomNode(t))return BX.pos(t,!1);if(t&&"object"==typeof t)return BX.type.isNumber(t.bottom)||(t.bottom=t.top),t;var e=BX.GetWindowInnerSize(),i=BX.GetWindowScrollPos(),n=this.getPopupContainer().offsetWidth,o=this.getPopupContainer().offsetHeight;return this.bindOptions.forceTop=!0,{left:e.innerWidth/2-n/2+i.scrollLeft,top:e.innerHeight/2-o/2+i.scrollTop,bottom:e.innerHeight/2-o/2+i.scrollTop,windowSize:e,windowScroll:i,popupWidth:n,popupHeight:o}},BX.PopupWindow.prototype.setAngle=function(t){if(!1===t&&null!==this.angle)return BX.remove(this.angle.element),void(this.angle=null);var e="popup-window-angly";if(null===this.angle){var i=this.bindOptions.position&&"top"===this.bindOptions.position?"bottom":"top",n=BX.PopupWindow.getOption("top"===i?"angleMinTop":"angleMinBottom"),o=BX.type.isNumber(t.offset)?t.offset:0,s=BX.PopupWindow.getOption("angleLeftOffset",null);o>0&&BX.type.isNumber(s)&&(o+=s-BX.PopupWindow.defaultOptions.angleLeftOffset),this.angle={element:BX.create("div",{props:{className:e+" "+e+"-"+i}}),position:i,offset:0,defaultOffset:Math.max(o,n)},this.getPopupContainer().appendChild(this.angle.element)}if("object"==typeof t&&t.position&&BX.util.in_array(t.position,["top","right","bottom","left","hide"])&&(BX.removeClass(this.angle.element,e+"-"+this.angle.position),BX.addClass(this.angle.element,e+"-"+t.position),this.angle.position=t.position),"object"==typeof t&&BX.type.isNumber(t.offset)){var p,u,a=t.offset;"top"===this.angle.position?(p=BX.PopupWindow.getOption("angleMinTop"),u=(u=this.getPopupContainer().offsetWidth-BX.PopupWindow.getOption("angleMaxTop"))<p?Math.max(p,a):u,this.angle.offset=Math.min(Math.max(p,a),u),this.angle.element.style.left=this.angle.offset+"px",this.angle.element.style.marginLeft=0):"bottom"===this.angle.position?(p=BX.PopupWindow.getOption("angleMinBottom"),u=(u=this.getPopupContainer().offsetWidth-BX.PopupWindow.getOption("angleMaxBottom"))<p?Math.max(p,a):u,this.angle.offset=Math.min(Math.max(p,a),u),this.angle.element.style.marginLeft=this.angle.offset+"px",this.angle.element.style.left=0):"right"===this.angle.position?(p=BX.PopupWindow.getOption("angleMinRight"),u=(u=this.getPopupContainer().offsetHeight-BX.PopupWindow.getOption("angleMaxRight"))<p?Math.max(p,a):u,this.angle.offset=Math.min(Math.max(p,a),u),this.angle.element.style.top=this.angle.offset+"px"):"left"===this.angle.position&&(p=BX.PopupWindow.getOption("angleMinLeft"),u=(u=this.getPopupContainer().offsetHeight-BX.PopupWindow.getOption("angleMaxLeft"))<p?Math.max(p,a):u,this.angle.offset=Math.min(Math.max(p,a),u),this.angle.element.style.top=this.angle.offset+"px")}},BX.PopupWindow.prototype.getWidth=function(){return this.width},BX.PopupWindow.prototype.setWidth=function(t){this.setWidthProperty("width",t)},BX.PopupWindow.prototype.getHeight=function(){return this.height},BX.PopupWindow.prototype.setHeight=function(t){this.setHeightProperty("height",t)},BX.PopupWindow.prototype.getMinWidth=function(){return this.minWidth},BX.PopupWindow.prototype.setMinWidth=function(t){this.setWidthProperty("minWidth",t)},BX.PopupWindow.prototype.getMinHeight=function(){return this.minHeight},BX.PopupWindow.prototype.setMinHeight=function(t){this.setHeightProperty("minHeight",t)},BX.PopupWindow.prototype.getMaxWidth=function(){return this.maxWidth},BX.PopupWindow.prototype.setMaxWidth=function(t){this.setWidthProperty("maxWidth",t)},BX.PopupWindow.prototype.getMaxHeight=function(){return this.maxHeight},BX.PopupWindow.prototype.setMaxHeight=function(t){this.setHeightProperty("maxHeight",t)},BX.PopupWindow.prototype.setWidthProperty=function(t,e){var i=["width","minWidth","maxWidth"];if(-1!==i.indexOf(t))if(BX.type.isNumber(e)&&e>=0)this[t]=e,this.getResizableContainer().style[t]=e+"px",this.getContentContainer().style.overflowX="auto",this.getPopupContainer().classList.add("popup-window-fixed-width"),this.getTitleContainer()&&BX.browser.IsIE11()&&(this.getTitleContainer().style[t]=e+"px");else if(null===e||!1===e){this[t]=null,this.getResizableContainer().style.removeProperty(BX.util.getCssName(t)),i.some((function(t){return""!==this.getResizableContainer().style.getPropertyValue(BX.util.getCssName(t))}),this)||(this.getContentContainer().style.removeProperty("overflow-x"),this.getPopupContainer().classList.remove("popup-window-fixed-width")),this.getTitleContainer()&&BX.browser.IsIE11()&&this.getTitleContainer().style.removeProperty(BX.util.getCssName(t))}},BX.PopupWindow.prototype.setHeightProperty=function(t,e){var i=["height","minHeight","maxHeight"];if(-1!==i.indexOf(t))if(BX.type.isNumber(e)&&e>=0)this[t]=e,this.getResizableContainer().style[t]=e+"px",this.getContentContainer().style.overflowY="auto",this.getPopupContainer().classList.add("popup-window-fixed-height");else if(null===e||!1===e){this[t]=null,this.getResizableContainer().style.removeProperty(BX.util.getCssName(t)),i.some((function(t){return""!==this.getResizableContainer().style.getPropertyValue(BX.util.getCssName(t))}),this)||(this.getContentContainer().style.removeProperty("overflow-y"),this.getPopupContainer().classList.remove("popup-window-fixed-height"))}},BX.PopupWindow.prototype.setPadding=function(t){BX.type.isNumber(t)&&t>=0?(this.padding=t,this.getPopupContainer().style.padding=t+"px"):null===t&&(this.padding=null,this.getPopupContainer().style.removeProperty("padding"))},BX.PopupWindow.prototype.getPadding=function(){return this.padding},BX.PopupWindow.prototype.setContentPadding=function(t){BX.type.isNumber(t)&&t>=0?(this.contentPadding=t,this.getContentContainer().style.padding=t+"px"):null===t&&(this.contentPadding=null,this.getContentContainer().style.removeProperty("padding"))},BX.PopupWindow.prototype.getContentPadding=function(){return this.contentPadding},BX.PopupWindow.prototype.setBackground=function(t){BX.type.isNotEmptyString(t)?(this.background=t,this.getPopupContainer().style.background=t):null===t&&(this.background=null,this.getPopupContainer().style.removeProperty("background"))},BX.PopupWindow.prototype.getBackground=function(){return this.background},BX.PopupWindow.prototype.setContentBackground=function(t){BX.type.isNotEmptyString(t)?(this.contentBackground=t,this.getContentContainer().style.background=t):null===t&&(this.contentBackground=null,this.getContentContainer().style.removeProperty("background"))},BX.PopupWindow.prototype.getContentBackground=function(){return this.contentBackground},BX.PopupWindow.prototype.isDestroyed=function(){return this.destroyed},BX.PopupWindow.prototype.setCacheable=function(t){this.cacheable=!1!==t},BX.PopupWindow.prototype.isCacheable=function(){return this.cacheable},BX.PopupWindow.prototype.setResizeMode=function(t){!0===t||BX.type.isPlainObject(t)?(this.resizeIcon||(this.resizeIcon=BX.create("div",{props:{className:"popup-window-resize"},events:{mousedown:BX.proxy(this.onResizeMouseDown,this)}}),this.getPopupContainer().appendChild(this.resizeIcon)),this.setMinWidth(t.minWidth),this.setMinHeight(t.minHeight)):!1===t&&this.resizeIcon&&(BX.remove(this.resizeIcon),this.resizeIcon=null)},BX.PopupWindow.prototype.getPopupContainer=function(){return this.popupContainer},BX.PopupWindow.prototype.getContentContainer=function(){return this.contentContainer},BX.PopupWindow.prototype.getResizableContainer=function(){return BX.browser.IsIE11()?this.getContentContainer():this.getPopupContainer()},BX.PopupWindow.prototype.getTitleContainer=function(){return this.titleBar},BX.PopupWindow.prototype.onTitleMouseDown=function(t){this._startDrag(t,{cursor:"move",callback:BX.proxy(this.move,this),eventName:"Drag"})},BX.PopupWindow.prototype.onResizeMouseDown=function(t){this._startDrag(t,{cursor:"nwse-resize",eventName:"Resize",callback:BX.proxy(this._resize,this)}),this.resizeContentPos=BX.pos(this.getResizableContainer()),this.resizeContentOffset=this.resizeContentPos.left-BX.pos(this.getPopupContainer()).left},BX.PopupWindow.prototype._resize=function(t,e,i,n){var o=i-this.resizeContentPos.left,s=n-this.resizeContentPos.top,p=BX.GetWindowScrollSize().scrollWidth;this.resizeContentPos.left+o+this.resizeContentOffset>=p&&(o=p-this.resizeContentPos.left-this.resizeContentOffset),o=Math.max(o,this.getMinWidth()),s=Math.max(s,this.getMinHeight()),null!==this.getMaxWidth()&&(o=Math.min(o,this.getMaxWidth())),null!==this.getMaxHeight()&&(s=Math.min(s,this.getMaxHeight())),this.setWidth(o),this.setHeight(s)},BX.PopupWindow.prototype.isTopAngle=function(){return null!==this.angle&&"top"===this.angle.position},BX.PopupWindow.prototype.isBottomAngle=function(){return null!==this.angle&&"bottom"===this.angle.position},BX.PopupWindow.prototype.isTopOrBottomAngle=function(){return null!==this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])},BX.PopupWindow.prototype.getAngleHeight=function(){return this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleTopOffset"):0},BX.PopupWindow.prototype.setOffset=function(t){BX.type.isPlainObject(t)&&(BX.type.isNumber(t.offsetLeft)&&(this.offsetLeft=t.offsetLeft+BX.PopupWindow.getOption("offsetLeft")),BX.type.isNumber(t.offsetTop)&&(this.offsetTop=t.offsetTop+BX.PopupWindow.getOption("offsetTop")))},BX.PopupWindow.prototype.setTitleBar=function(t){this.titleBar&&("object"==typeof t&&BX.type.isDomNode(t.content)?(this.titleBar.innerHTML="",this.titleBar.appendChild(t.content)):"string"==typeof t&&(this.titleBar.innerHTML="",this.titleBar.appendChild(BX.create("span",{props:{className:"popup-window-titlebar-text"},text:t}))),this.params.draggable&&(this.titleBar.style.cursor="move",BX.bind(this.titleBar,"mousedown",BX.proxy(this.onTitleMouseDown,this))))},BX.PopupWindow.prototype.setClosingByEsc=function(t){(t=!BX.type.isBoolean(t)||t)?(this.closeByEsc=!0,this.bindClosingByEsc()):(this.closeByEsc=!1,this.unbindClosingByEsc())},BX.PopupWindow.prototype.bindClosingByEsc=function(){this.closeByEsc&&!this.isCloseByEscBinded&&(BX.bind(document,"keyup",this.handleDocumentKeyUp),this.isCloseByEscBinded=!0)},BX.PopupWindow.prototype.unbindClosingByEsc=function(){this.isCloseByEscBinded&&(BX.unbind(document,"keyup",this.handleDocumentKeyUp),this.isCloseByEscBinded=!1)},BX.PopupWindow.prototype.setAutoHide=function(t){(t=!BX.type.isBoolean(t)||t)?(this.autoHide=!0,this.bindAutoHide()):(this.autoHide=!1,this.unbindAutoHide())},BX.PopupWindow.prototype.bindAutoHide=function(){this.autoHide&&!this.isAutoHideBinded&&this.isShown()&&(this.isAutoHideBinded=!0,this.isCompatibleMode()&&BX.bind(this.getPopupContainer(),"click",this.cancelBubble),this.overlay&&this.overlay.element?BX.bind(this.overlay.element,"click",this.handleOverlayClick):this.isCompatibleMode()?BX.bind(document,"click",this.handleAutoHide):document.addEventListener("click",this.handleAutoHide,!0))},BX.PopupWindow.prototype.unbindAutoHide=function(){this.isAutoHideBinded&&(this.isAutoHideBinded=!1,this.isCompatibleMode()&&BX.unbind(this.getPopupContainer(),"click",this.cancelBubble),this.overlay&&this.overlay.element?BX.unbind(this.overlay.element,"click",this.handleOverlayClick):this.isCompatibleMode()?BX.unbind(document,"click",this.handleAutoHide):document.removeEventListener("click",this.handleAutoHide,!0))},BX.PopupWindow.prototype.handleAutoHide=function(t){this.isDestroyed()||(null!==this.autoHideHandler?this.autoHideHandler(t)&&this._tryCloseByEvent(t):t.target===this.getPopupContainer()||this.getPopupContainer().contains(t.target)||this._tryCloseByEvent(t))},BX.PopupWindow.prototype._tryCloseByEvent=function(t){this.isCompatibleMode()?this.tryCloseByEvent(t):setTimeout(BX.proxy(this.tryCloseByEvent,this),0,t)},BX.PopupWindow.prototype.handleOverlayClick=function(t){this.tryCloseByEvent(t),t.stopPropagation()},BX.PopupWindow.prototype.setOverlay=function(t){null===this.overlay&&(this.overlay={element:BX.create("div",{props:{className:"popup-window-overlay",id:"popup-window-overlay-"+this.uniquePopupId}})},this.adjustOverlayZindex(),this.resizeOverlay(),this.appendContainer.appendChild(this.overlay.element)),t&&t.hasOwnProperty("opacity")&&BX.type.isNumber(t.opacity)&&t.opacity>=0&&t.opacity<=100&&(BX.browser.IsIE()&&!BX.browser.IsIE9()?this.overlay.element.style.filter="alpha(opacity="+t.opacity+")":(this.overlay.element.style.filter="none",this.overlay.element.style.opacity=parseFloat(t.opacity/100).toPrecision(3))),t&&t.backgroundColor&&(this.overlay.element.style.backgroundColor=t.backgroundColor)},BX.PopupWindow.prototype.removeOverlay=function(){null!==this.overlay&&null!==this.overlay.element&&BX.remove(this.overlay.element),this.overlayTimeout&&(clearInterval(this.overlayTimeout),this.overlayTimeout=null),this.overlay=null},BX.PopupWindow.prototype.hideOverlay=function(){null!==this.overlay&&null!==this.overlay.element&&(this.overlayTimeout&&(clearInterval(this.overlayTimeout),this.overlayTimeout=null),this.overlay.element.style.display="none")},BX.PopupWindow.prototype.showOverlay=function(){if(null!==this.overlay&&null!==this.overlay.element){this.overlay.element.style.display="block";var t=this.getPopupContainer().offsetHeight;this.overlayTimeout=setInterval(function(){t!==this.getPopupContainer().offsetHeight&&(this.resizeOverlay(),t=this.getPopupContainer().offsetHeight)}.bind(this),1e3)}},BX.PopupWindow.prototype.resizeOverlay=function(){if(null!==this.overlay&&null!==this.overlay.element){var t=BX.GetWindowScrollSize(),e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);this.overlay.element.style.width=t.scrollWidth+"px",this.overlay.element.style.height=e+"px"}},BX.PopupWindow.prototype.getZindex=function(){return null!==this.overlay?this.params.zIndexAbsolute>0?this.params.zIndexAbsolute:BX.PopupWindow.getOption("popupOverlayZindex")+this.params.zIndex:this.params.zIndexAbsolute>0?this.params.zIndexAbsolute:BX.PopupWindow.getOption("popupZindex")+this.params.zIndex},BX.PopupWindow.prototype.adjustOverlayZindex=function(){null!==this.overlay&&null!==this.overlay.element&&(this.overlay.element.style.zIndex=parseInt(this.getPopupContainer().style.zIndex)-1)},BX.PopupWindow.prototype.show=function(){this.isShown()||this.isDestroyed()||(this.firstShow||(BX.onCustomEvent(this,"onPopupFirstShow",[this]),this.firstShow=!0),BX.onCustomEvent(this,"onPopupShow",[this]),this.showOverlay(),this.getPopupContainer().style.display="block",this.adjustPosition(),this.animateOpening(function(){this.isDestroyed()||(BX.removeClass(this.getPopupContainer(),this.animationShowClassName),BX.onCustomEvent(this,"onAfterPopupShow",[this]))}.bind(this)),this.bindClosingByEsc(),this.isCompatibleMode()?setTimeout(function(){this.bindAutoHide()}.bind(this),100):this.bindAutoHide())},BX.PopupWindow.prototype.animateOpening=function(t){if(BX.removeClass(this.getPopupContainer(),this.animationCloseClassName),null!==this.animationShowClassName)if(BX.addClass(this.getPopupContainer(),this.animationShowClassName),null!==this.animationCloseEventType){var e=this.animationCloseEventType+"end";this.getPopupContainer().addEventListener(e,(function i(){this.removeEventListener(e,i),t()}))}else t();else t()},BX.PopupWindow.prototype.animateClosing=function(t){if(BX.removeClass(this.getPopupContainer(),this.animationShowClassName),null!==this.animationCloseClassName)if(BX.addClass(this.getPopupContainer(),this.animationCloseClassName),null!==this.animationCloseEventType){var e=this.animationCloseEventType+"end";this.getPopupContainer().addEventListener(e,(function i(){this.removeEventListener(e,i),t()}))}else t();else t()},BX.PopupWindow.prototype.isShown=function(){return!this.isDestroyed()&&"block"===this.getPopupContainer().style.display},BX.PopupWindow.prototype.cancelBubble=function(e){(e=e||t.event).stopPropagation?e.stopPropagation():e.cancelBubble=!0},BX.PopupWindow.prototype.close=function(){!this.isDestroyed()&&this.isShown()&&(BX.onCustomEvent(this,"onPopupClose",[this]),this.isDestroyed()||this.animateClosing(function(){this.isDestroyed()||(this.hideOverlay(),this.getPopupContainer().style.display="none",BX.removeClass(this.getPopupContainer(),this.animationCloseClassName),this.unbindClosingByEsc(),this.isCompatibleMode()?setTimeout(function(){this.unbindAutoHide()}.bind(this),0):this.unbindAutoHide(),this.isCacheable()||this.destroy())}.bind(this)))},BX.PopupWindow.prototype.toggle=function(){this.isShown()?this.close():this.show()},BX.PopupWindow.prototype.tryCloseByEvent=function(t){this.isLeftButton(t)&&this.close()},BX.PopupWindow.prototype.setAnimation=function(t){if(BX.type.isPlainObject(t))this.animationShowClassName=BX.type.isNotEmptyString(t.showClassName)?t.showClassName:null,this.animationCloseClassName=BX.type.isNotEmptyString(t.closeClassName)?t.closeClassName:null,this.animationCloseEventType=BX.util.in_array(t.closeAnimationType,["animation","transition"])?t.closeAnimationType:null;else if(BX.type.isNotEmptyString(t)){var e=t;"fading"===e?(this.animationShowClassName="popup-window-show-animation-opacity",this.animationCloseClassName="popup-window-close-animation-opacity",this.animationCloseEventType="animation"):"fading-slide"===e?(this.animationShowClassName="popup-window-show-animation-opacity-transform",this.animationCloseClassName="popup-window-close-animation-opacity",this.animationCloseEventType="animation"):"scale"===e&&(this.animationShowClassName="popup-window-show-animation-scale",this.animationCloseClassName="popup-window-close-animation-opacity",this.animationCloseEventType="animation")}else!1!==t&&null!==t||(this.animationShowClassName=null,this.animationCloseClassName=null,this.animationCloseEventType=null)},BX.PopupWindow.prototype.handleCloseIconClick=function(t){this.tryCloseByEvent(t),t.stopPropagation()},BX.PopupWindow.prototype.isLeftButton=function(t){return 0===t.button},BX.PopupWindow.prototype.handleDocumentKeyUp=function(e){27===(e=e||t.event).keyCode&&n(this.getZindex(),BX.proxy(this.close,this))},BX.PopupWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupDestroy",[this]),this.destroyed=!0,this.unbindClosingByEsc(),this.isCompatibleMode()?setTimeout(function(){this.unbindAutoHide()}.bind(this),0):this.unbindAutoHide(),BX.unbindAll(this),BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this)),BX.unbind(t,"resize",this.handleResizeWindow),BX.remove(this.popupContainer),this.removeOverlay(),this.popupContainer=null,this.contentContainer=null,this.closeIcon=null,this.titleBar=null,this.buttonsContainer=null,this.angle=null,this.resizeIcon=null},BX.PopupWindow.prototype.enterFullScreen=function(){BX.PopupWindow.fullscreenStatus?document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():BX.browser.IsChrome()||BX.browser.IsSafari()?(this.contentContainer.webkitRequestFullScreen(this.contentContainer.ALLOW_KEYBOARD_INPUT),BX.bind(t,"webkitfullscreenchange",this.fullscreenBind=BX.proxy(this.eventFullScreen,this))):BX.browser.IsFirefox()&&(this.contentContainer.mozRequestFullScreen(this.contentContainer.ALLOW_KEYBOARD_INPUT),BX.bind(t,"mozfullscreenchange",this.fullscreenBind=BX.proxy(this.eventFullScreen,this)))},BX.PopupWindow.prototype.eventFullScreen=function(e){BX.PopupWindow.fullscreenStatus?(BX.browser.IsChrome()||BX.browser.IsSafari()?BX.unbind(t,"webkitfullscreenchange",this.fullscreenBind):BX.browser.IsFirefox()&&BX.unbind(t,"mozfullscreenchange",this.fullscreenBind),BX.removeClass(this.contentContainer,"popup-window-fullscreen",[this.contentContainer]),BX.PopupWindow.fullscreenStatus=!1,BX.onCustomEvent(this,"onPopupFullscreenLeave"),this.adjustPosition()):(BX.addClass(this.contentContainer,"popup-window-fullscreen"),BX.PopupWindow.fullscreenStatus=!0,BX.onCustomEvent(this,"onPopupFullscreenEnter",[this.contentContainer]),this.adjustPosition())},BX.PopupWindow.prototype.adjustPosition=function(t){t&&"object"==typeof t&&(this.bindOptions=t);var e=this.getBindElementPos(this.bindElement);if(this.bindOptions.forceBindPosition||null===this.bindElementPos||e.top!==this.bindElementPos.top||e.left!==this.bindElementPos.left){this.bindElementPos=e;var i=e.windowSize?e.windowSize:BX.GetWindowInnerSize(),n=e.windowScroll?e.windowScroll:BX.GetWindowScrollPos(),o=e.popupWidth?e.popupWidth:this.popupContainer.offsetWidth,s=e.popupHeight?e.popupHeight:this.popupContainer.offsetHeight,p=BX.PopupWindow.getOption("angleTopOffset"),u=this.bindElementPos.left+this.offsetLeft-(this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleLeftOffset"):0);if(!this.bindOptions.forceLeft&&u+o+this.bordersWidth>=i.innerWidth+n.scrollLeft&&i.innerWidth+n.scrollLeft-o-this.bordersWidth>0){var a=u;u=i.innerWidth+n.scrollLeft-o-this.bordersWidth,this.isTopOrBottomAngle()&&this.setAngle({offset:a-u+this.angle.defaultOffset})}else this.isTopOrBottomAngle()&&this.setAngle({offset:this.angle.defaultOffset+(u<0?u:0)});u<0&&(u=0);var h=0;this.bindOptions.position&&"top"===this.bindOptions.position?(h=this.bindElementPos.top-s-this.offsetTop-(this.isBottomAngle()?p:0))<0||!this.bindOptions.forceTop&&h<n.scrollTop?(h=this.bindElementPos.bottom+this.offsetTop,null!==this.angle&&(h+=p,this.setAngle({position:"top"}))):this.isTopAngle()?(h=h-p+BX.PopupWindow.getOption("positionTopXOffset"),this.setAngle({position:"bottom"})):h+=BX.PopupWindow.getOption("positionTopXOffset"):(h=this.bindElementPos.bottom+this.offsetTop+this.getAngleHeight(),!this.bindOptions.forceTop&&h+s>i.innerHeight+n.scrollTop&&this.bindElementPos.top-s-this.getAngleHeight()>=0?(h=this.bindElementPos.top-s,this.isTopOrBottomAngle()&&(h-=p,this.setAngle({position:"bottom"})),h+=BX.PopupWindow.getOption("positionTopXOffset")):this.isBottomAngle()&&(h+=p,this.setAngle({position:"top"}))),h<0&&(h=0),BX.adjust(this.popupContainer,{style:{top:h+"px",left:u+"px",zIndex:this.getZindex()}}),this.adjustOverlayZindex()}},BX.PopupWindow.prototype.handleResizeWindow=function(t){this.isShown()&&(this.adjustPosition(),null!==this.overlay&&this.resizeOverlay())},BX.PopupWindow.prototype.move=function(t,e,i,n){var o=parseInt(this.popupContainer.style.left)+t,s=parseInt(this.popupContainer.style.top)+e;if("object"==typeof this.params.draggable&&this.params.draggable.restrict){o<0&&(o=0);var p=BX.GetWindowScrollSize(),u=this.popupContainer.offsetWidth,a=this.popupContainer.offsetHeight;o>p.scrollWidth-u&&(o=p.scrollWidth-u),s>p.scrollHeight-a&&(s=p.scrollHeight-a),s<0&&(s=0)}this.popupContainer.style.left=o+"px",this.popupContainer.style.top=s+"px"},BX.PopupWindow.prototype._startDrag=function(e,i){return e=e||t.event,BX.fixEventPageXY(e),i=i||{},BX.type.isNotEmptyString(i.cursor)&&(this.dragOptions.cursor=i.cursor),BX.type.isNotEmptyString(i.eventName)&&(this.dragOptions.eventName=i.eventName),BX.type.isFunction(i.callback)&&(this.dragOptions.callback=i.callback),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged=!1,BX.bind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.bind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.setCapture&&document.body.setCapture(),document.body.ondrag=BX.False,document.body.onselectstart=BX.False,document.body.style.cursor=this.dragOptions.cursor,document.body.style.MozUserSelect="none",this.popupContainer.style.MozUserSelect="none",BX.PreventDefault(e)},BX.PopupWindow.prototype._moveDrag=function(e){e=e||t.event,BX.fixEventPageXY(e),this.dragPageX===e.pageX&&this.dragPageY===e.pageY||(this.dragOptions.callback(e.pageX-this.dragPageX,e.pageY-this.dragPageY,e.pageX,e.pageY),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged||(BX.onCustomEvent(this,"onPopup"+this.dragOptions.eventName+"Start",[this]),this.dragged=!0),BX.onCustomEvent(this,"onPopup"+this.dragOptions.eventName,[this]))},BX.PopupWindow.prototype._stopDrag=function(t){return document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.ondrag=null,document.body.onselectstart=null,document.body.style.cursor="",document.body.style.MozUserSelect="",this.popupContainer.style.MozUserSelect="",BX.onCustomEvent(this,"onPopup"+this.dragOptions.eventName+"End",[this]),this.dragged=!1,BX.PreventDefault(t)},BX.PopupWindow.options={},BX.PopupWindow.defaultOptions={angleLeftOffset:40,positionTopXOffset:-11,angleTopOffset:10,popupZindex:1e3,popupOverlayZindex:1100,angleMinLeft:10,angleMaxLeft:10,angleMinRight:10,angleMaxRight:10,angleMinBottom:23,angleMaxBottom:25,angleMinTop:23,angleMaxTop:25,offsetLeft:0,offsetTop:0},BX.PopupWindow.setOptions=function(t){if(t&&"object"==typeof t)for(var e in t)BX.PopupWindow.options[e]=t[e]},BX.PopupWindow.getOption=function(t,e){return void 0!==BX.PopupWindow.options[t]?BX.PopupWindow.options[t]:void 0!==e?e:BX.PopupWindow.defaultOptions[t]},BX.PopupWindowButton=function(t){for(var e in this.popupWindow=null,this.params=t||{},this.text=this.params.text||"",this.id=this.params.id||"",this.className=this.params.className||"",this.events=this.params.events||{},this.contextEvents={},this.events)this.contextEvents[e]=BX.proxy(this.events[e],this);this.buttonNode=BX.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},events:this.contextEvents,text:this.text})},BX.PopupWindowButton.prototype.render=function(){return this.buttonNode},BX.PopupWindowButton.prototype.getId=function(){return this.id},BX.PopupWindowButton.prototype.getName=function(){return this.name},BX.PopupWindowButton.prototype.getContainer=function(){return this.buttonNode},BX.PopupWindowButton.prototype.setName=function(t){this.text=t||"",this.buttonNode&&(BX.cleanNode(this.buttonNode),BX.adjust(this.buttonNode,{text:this.text}))},BX.PopupWindowButton.prototype.setClassName=function(t){this.buttonNode&&(BX.type.isString(this.className)&&""!==this.className&&BX.removeClass(this.buttonNode,this.className),BX.addClass(this.buttonNode,t)),this.className=t},BX.PopupWindowButton.prototype.addClassName=function(t){this.buttonNode&&(BX.addClass(this.buttonNode,t),this.className=this.buttonNode.className)},BX.PopupWindowButton.prototype.removeClassName=function(t){this.buttonNode&&(BX.removeClass(this.buttonNode,t),this.className=this.buttonNode.className)},BX.PopupWindowButtonLink=function(t){BX.PopupWindowButtonLink.superclass.constructor.apply(this,arguments),this.buttonNode=BX.create("span",{props:{className:"popup-window-button popup-window-button-link"+(this.className.length>0?" "+this.className:""),id:this.id},text:this.text,events:this.contextEvents})},BX.extend(BX.PopupWindowButtonLink,BX.PopupWindowButton),BX.PopupWindowCustomButton=function(t){BX.PopupWindowCustomButton.superclass.constructor.apply(this,arguments),this.buttonNode=BX.create("span",{props:{className:this.className.length>0?" "+this.className:"",id:this.id},events:this.contextEvents,text:this.text})},BX.extend(BX.PopupWindowCustomButton,BX.PopupWindowButton),BX.PopupMenu={Data:{},currentItem:null,show:function(t){null!==this.currentItem&&this.currentItem.popupWindow.close(),this.currentItem=this.create.apply(this,arguments),this.currentItem.popupWindow.show()},create:function(t){var e=null,i=arguments[1],n=arguments[2],o=arguments[3];if(!BX.type.isPlainObject(t)||i||n||o)e=t;else if(e=t.id,!BX.type.isNotEmptyString(e))throw new Error("BX.PopupMenu.create: 'id' parameter is required.");return this.Data[e]||(this.Data[e]=new BX.PopupMenuWindow(t,i,n,o),BX.addCustomEvent(this.Data[e],"onPopupMenuDestroy",this.onPopupDestroy.bind(this))),this.Data[e]},getCurrentMenu:function(){return this.currentItem},getMenuById:function(t){return this.Data[t]?this.Data[t]:null},onPopupDestroy:function(t){this.destroy(t.id)},destroy:function(t){var e=this.getMenuById(t);e&&(this.currentItem===e&&(this.currentItem=null),e.popupWindow.destroy(),delete this.Data[t])}},BX.PopupMenuWindow=function(t,e,i,n){if(!BX.type.isPlainObject(t)||e||i||n||((n=t).compatibleMode=!1,t=n.id,e=n.bindElement,i=n.items,BX.type.isNotEmptyString(t)||(t="menu-popup-"+BX.util.getRandomString().toLowerCase())),this.id=t,this.bindElement=e,this.menuItems=[],this.itemsContainer=null,this.params=n&&"object"==typeof n?n:{},this.parentMenuWindow=null,this.parentMenuItem=null,i&&BX.type.isArray(i))for(var o=0;o<i.length;o++)this.addMenuItemInternal(i[o],null);this.layout={menuContainer:null,itemsContainer:null},this.popupWindow=this.__createPopup()},BX.PopupMenuWindow.prototype.__createPopup=function(){for(var t=[],e=0;e<this.menuItems.length;e++){var i=this.menuItems[e].getLayout();t.push(i.item)}var n=BX.mergeEx({closeByEsc:!1,angle:!1,autoHide:!0,offsetTop:1,offsetLeft:0,animation:"fading"},this.params);n.noAllPaddings=!0,n.darkMode=!1,n.autoHideHandler=this.handleAutoHide.bind(this),n.content=this.layout.menuContainer=BX.create("div",{props:{className:"menu-popup"},children:[this.layout.itemsContainer=this.itemsContainer=BX.create("div",{props:{className:"menu-popup-items"},children:t})]}),n.events={onPopupClose:this.onMenuWindowClose.bind(this),onPopupDestroy:this.onMenuWindowDestroy.bind(this)};var o=!1===n.compatibleMode?this.getId():"menu-popup-"+this.getId(),s=new BX.PopupWindow(o,this.bindElement,n);if(this.params&&this.params.events)for(var p in this.params.events)this.params.events.hasOwnProperty(p)&&BX.addCustomEvent(s,p,this.params.events[p]);return s},BX.PopupMenuWindow.prototype.getPopupWindow=function(){return this.popupWindow},BX.PopupMenuWindow.prototype.show=function(){BX.onCustomEvent(this,"onPopupMenuShow",[this]),this.getPopupWindow().show()},BX.PopupMenuWindow.prototype.close=function(){BX.onCustomEvent(this,"onPopupMenuClose",[this]),this.getPopupWindow().close()},BX.PopupMenuWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupMenuDestroy",[this]),this.getPopupWindow().destroy()},BX.PopupMenuWindow.prototype.toggle=function(){this.getPopupWindow().isShown()?this.close():this.show()},BX.PopupMenuWindow.prototype.getId=function(){return this.id},BX.PopupMenuWindow.prototype.onMenuWindowClose=function(){for(var t=0;t<this.menuItems.length;t++){this.menuItems[t].closeSubMenu()}},BX.PopupMenuWindow.prototype.onMenuWindowDestroy=function(){for(var t=0;t<this.menuItems.length;t++){this.menuItems[t].destroySubMenu()}},BX.PopupMenuWindow.prototype.handleAutoHide=function(t){return!this.containsTarget(t.target)},BX.PopupMenuWindow.prototype.containsTarget=function(t){var e=this.getPopupWindow().getPopupContainer();return!(!this.getPopupWindow().isShown()||t!==e&&!e.contains(t))||this.getMenuItems().some((function(e){return e.getSubMenu()&&e.getSubMenu().containsTarget(t)}))},BX.PopupMenuWindow.prototype.setParentMenuWindow=function(t){t instanceof BX.PopupMenuWindow&&(this.parentMenuWindow=t)},BX.PopupMenuWindow.prototype.getParentMenuWindow=function(){return this.parentMenuWindow},BX.PopupMenuWindow.prototype.getRootMenuWindow=function(){for(var t=null,e=this.getParentMenuWindow();null!==e;)t=e,e=e.getParentMenuWindow();return t},BX.PopupMenuWindow.prototype.setParentMenuItem=function(t){t instanceof BX.PopupMenuItem&&(this.parentMenuItem=t)},BX.PopupMenuWindow.prototype.getParentMenuItem=function(){return this.parentMenuItem},BX.PopupMenuWindow.prototype.addMenuItem=function(t,e){var i=this.addMenuItemInternal(t,e);if(!i)return null;var n=i.getLayout(),o=this.getMenuItem(e);if(null!==o){var s=o.getLayout();this.itemsContainer.insertBefore(n.item,s.item)}else this.itemsContainer.appendChild(n.item);return i},BX.PopupMenuWindow.prototype.addMenuItemInternal=function(t,e){if(!t||!t.delimiter&&!BX.type.isNotEmptyString(t.text)||t.id&&null!==this.getMenuItem(t.id))return null;BX.type.isNumber(this.params.menuShowDelay)&&(t.menuShowDelay=this.params.menuShowDelay);var i=new BX.PopupMenuItem(t);i.setMenuWindow(this);var n=this.getMenuItemPosition(e);return n>=0?this.menuItems=BX.util.insertIntoArray(this.menuItems,n,i):this.menuItems.push(i),i},BX.PopupMenuWindow.prototype.removeMenuItem=function(t){var e=this.getMenuItem(t);if(e){for(var i=0;i<this.menuItems.length;i++)if(this.menuItems[i]===e){e.destroySubMenu(),this.menuItems=BX.util.deleteFromArray(this.menuItems,i);break}if(!this.menuItems.length){var n=e.getMenuWindow();if(n){var o=n.getParentMenuItem();o?o.destroySubMenu():n.destroy()}}e.layout.item.parentNode.removeChild(e.layout.item),e.layout={item:null,text:null}}},BX.PopupMenuWindow.prototype.getMenuItem=function(t){for(var e=0;e<this.menuItems.length;e++)if(this.menuItems[e].id&&this.menuItems[e].id===t)return this.menuItems[e];return null},BX.PopupMenuWindow.prototype.getMenuItems=function(){return this.menuItems},BX.PopupMenuWindow.prototype.getMenuItemPosition=function(t){if(t)for(var e=0;e<this.menuItems.length;e++)if(this.menuItems[e].id&&this.menuItems[e].id===t)return e;return-1},BX.PopupMenuItem=function(t){if(t=t||{},this.options=t,this.id=t.id||BX.util.getRandomString().toLowerCase(),this.text=BX.type.isNotEmptyString(t.text)?t.text:"",this.title=BX.type.isNotEmptyString(t.title)?t.title:"",this.delimiter=!0===t.delimiter,this.href=BX.type.isNotEmptyString(t.href)?t.href:null,this.target=BX.type.isNotEmptyString(t.target)?t.target:null,this.dataset=BX.type.isPlainObject(t.dataset)?t.dataset:null,this.className=BX.type.isNotEmptyString(t.className)?t.className:null,this.menuShowDelay=BX.type.isNumber(t.menuShowDelay)?t.menuShowDelay:300,this.subMenuOffsetX=BX.type.isNumber(t.subMenuOffsetX)?t.subMenuOffsetX:4,this._items=BX.type.isArray(t.items)?t.items:[],this.disabled=!0===t.disabled,this.cacheable=!0===t.cacheable,this.onclick=BX.type.isNotEmptyString(t.onclick)||BX.type.isFunction(t.onclick)?t.onclick:null,BX.type.isPlainObject(t.events))for(var e in t.events)BX.addCustomEvent(this,e,t.events[e]);for(var i in this.menuWindow=null,this.subMenuWindow=null,this.layout={item:null,text:null},this.getLayout(),this.events={},this.items=[],t)t.hasOwnProperty(i)&&void 0===this[i]&&(this[i]=t[i])},BX.PopupMenuItem.prototype={getLayout:function(){return this.layout.item||(this.delimiter?BX.type.isNotEmptyString(this.text)?this.layout.item=BX.create("span",{props:{className:"popup-window-delimiter-section"},children:[this.layout.text=BX.create("span",{props:{className:"popup-window-delimiter-text"},html:this.text})]}):this.layout.item=BX.create("span",{props:{className:"popup-window-delimiter"}}):(this.layout.item=BX.create(this.href?"a":"span",{props:{className:["menu-popup-item",this.className?this.className:"menu-popup-no-icon",this.hasSubMenu()?"menu-popup-item-submenu":""].join(" ")},attrs:{title:this.title,onclick:BX.type.isString(this.onclick)?this.onclick:"",target:this.target?this.target:""},dataset:this.dataset,events:BX.type.isFunction(this.onclick)?{click:BX.delegate(this.onItemClick,this)}:null,children:[BX.create("span",{props:{className:"menu-popup-item-icon"}}),this.layout.text=BX.create("span",{props:{className:"menu-popup-item-text"},html:this.text})]}),this.href&&(this.layout.item.href=this.href),this.isDisabled()&&this.disable(),BX.bind(this.layout.item,"mouseenter",this.onItemMouseEnter.bind(this)),BX.bind(this.layout.item,"mouseleave",this.onItemMouseLeave.bind(this)))),this.layout},getContainer:function(){return this.getLayout().item},getTextContainer:function(){return this.getLayout().text},getText:function(){return this.text},setText:function(t){BX.type.isString(t)&&(this.text=t,this.getTextContainer().innerHTML=t)},onItemClick:function(t){this.onclick.call(this.menuWindow,t,this)},onItemMouseEnter:function(t){this.isDisabled()||(BX.onCustomEvent(this,"onMouseEnter"),this.subMenuTimeout&&clearTimeout(this.subMenuTimeout),this.hasSubMenu()?this.subMenuTimeout=setTimeout(function(){this.showSubMenu()}.bind(this),this.menuShowDelay):this.subMenuTimeout=setTimeout(function(){this.closeSiblings()}.bind(this),this.menuShowDelay))},onItemMouseLeave:function(t){this.isDisabled()||(BX.onCustomEvent(this,"onMouseLeave"),this.subMenuTimeout&&clearTimeout(this.subMenuTimeout))},hasSubMenu:function(){return null!==this.subMenuWindow||this._items.length},showSubMenu:function(){if(this.addSubMenu(this._items),this.subMenuWindow){BX.addClass(this.layout.item,"menu-popup-item-open"),this.closeSiblings(),this.closeChildren();var t=this.subMenuWindow.getPopupWindow();t.isShown()||(BX.onCustomEvent(this,"onSubMenuShow"),t.show()),this.adjustSubMenu()}},addSubMenu:function(t){if(null===this.subMenuWindow&&BX.type.isArray(t)&&t.length){var e=(this.getMenuWindow().getRootMenuWindow()||this.getMenuWindow()).params;return e.autoHide=!1,e.menuShowDelay=this.menuShowDelay,e.cacheable=this.isCacheable(),e.zIndexAbsolute=this.getMenuWindow().getPopupWindow().getZindex()+2,e.bindOptions={forceTop:!0,forceLeft:!0,forceBindPosition:!0},delete e.zIndex,delete e.events,delete e.angle,delete e.overlay,this.subMenuWindow=new BX.PopupMenuWindow("popup-submenu-"+this.id,this.layout.item,t,e),this.subMenuWindow.setParentMenuWindow(this.getMenuWindow()),this.subMenuWindow.setParentMenuItem(this),BX.addCustomEvent(this.subMenuWindow.getPopupWindow(),"onPopupDestroy",this.handleSubMenuDestroy.bind(this)),BX.addClass(this.layout.item,"menu-popup-item-submenu"),this.subMenuWindow}},handleSubMenuDestroy:function(){this.subMenuWindow=null},closeSubMenu:function(){this.subMenuWindow&&(BX.removeClass(this.layout.item,"menu-popup-item-open"),this.closeChildren(),this.subMenuWindow.getPopupWindow().isShown()&&BX.onCustomEvent(this,"onSubMenuClose"),this.subMenuWindow.close())},closeSiblings:function(){for(var t=this.menuWindow.getMenuItems(),e=0;e<t.length;e++)t[e]!==this&&t[e].closeSubMenu()},closeChildren:function(){if(this.subMenuWindow)for(var t=this.subMenuWindow.getMenuItems(),e=0;e<t.length;e++)t[e].closeSubMenu()},destroySubMenu:function(){this.subMenuWindow&&(BX.removeClass(this.layout.item,"menu-popup-item-open menu-popup-item-submenu"),this.destroyChildren(),this.subMenuWindow.destroy(),this.subMenuWindow=null,this._items=[])},destroyChildren:function(){if(this.subMenuWindow)for(var t=this.subMenuWindow.getMenuItems(),e=0;e<t.length;e++)t[e].destroySubMenu()},adjustSubMenu:function(){if(this.subMenuWindow&&this.layout.item){var t=this.subMenuWindow.getPopupWindow(),e=this.layout.item.getBoundingClientRect(),i=e.width+this.subMenuOffsetX,n=e.height+this.getPopupPadding(),o=e.height/2-this.getPopupPadding(),s="left",p=t.getPopupContainer().offsetWidth,u=t.getPopupContainer().offsetHeight,a=e.top+u,h=document.documentElement.clientWidth,r=a-document.documentElement.clientHeight;if(r>0){var l=Math.ceil(r/e.height)*e.height;l>e.top&&(l-=Math.ceil((l-e.top)/e.height)*e.height),e.bottom>a-l&&(l-=e.bottom-(a-l)+this.getPopupPadding()),n+=l,o+=l}if(e.left+i+p>h)e.left-p-this.subMenuOffsetX>0&&(i=-p-this.subMenuOffsetX,s="right");t.setBindElement(this.layout.item),t.setOffset({offsetLeft:i,offsetTop:-n}),t.setAngle({position:s,offset:o}),t.adjustPosition()}},getPopupPadding:function(){if(!BX.type.isNumber(this.popupPadding))if(this.subMenuWindow){var t=this.subMenuWindow.layout.menuContainer;this.popupPadding=parseInt(BX.style(t,"paddingTop"),10)}else this.popupPadding=0;return this.popupPadding},getSubMenu:function(){return this.subMenuWindow},getId:function(){return this.id},setMenuWindow:function(t){this.menuWindow=t},getMenuWindow:function(){return this.menuWindow},getMenuShowDelay:function(){return this.menuShowDelay},enable:function(){this.disabled=!1,this.getContainer().classList.remove("menu-popup-item-disabled")},disable:function(){this.disabled=!0,this.closeSubMenu(),this.getContainer().classList.add("menu-popup-item-disabled")},isDisabled:function(){return this.disabled},setCacheable:function(t){this.cacheable=!1!==t},isCacheable:function(){return this.cacheable}},t.BXInputPopup=function(t){this.id=t.id||"bx-inp-popup-"+Math.round(1e6*Math.random()),this.handler=t.handler||!1,this.values=t.values||!1,this.pInput=t.input,this.bValues=!!this.values,this.defaultValue=t.defaultValue||"",this.openTitle=t.openTitle||"",this.className=t.className||"",this.noMRclassName=t.noMRclassName||"ec-no-rm",this.emptyClassName=t.noMRclassName||"ec-label";var e=this;this.curInd=!1,this.bValues?(this.pInput.onfocus=this.pInput.onclick=function(t){return this.value==e.defaultValue&&(this.value="",this.className=e.className),e.ShowPopup(),BX.PreventDefault(t)},this.pInput.onblur=function(){e.bShowed&&setTimeout((function(){e.ClosePopup(!0)}),200),e.OnChange()}):(this.pInput.className=this.noMRclassName,this.pInput.onblur=BX.proxy(this.OnChange,this))},BXInputPopup.prototype={ShowPopup:function(){if(!this.bShowed){var t=this;if(!this.oPopup){for(var e,i=BX.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}}),n=0,o=this.values.length;n<o;n++)e=i.appendChild(BX.create("DIV",{props:{id:"bxecmr_"+n},text:this.values[n].NAME,events:{mouseover:function(){BX.addClass(this,"bxecplloc-over")},mouseout:function(){BX.removeClass(this,"bxecplloc-over")},click:function(){var e=this.id.substr("bxecmr_".length);t.pInput.value=t.values[e].NAME,t.curInd=e,t.OnChange(),t.ClosePopup(!0)}}})),this.values[n].DESCRIPTION&&(e.title=this.values[n].DESCRIPTION),this.values[n].CLASS_NAME&&BX.addClass(e,this.values[n].CLASS_NAME),this.values[n].URL&&e.appendChild(BX.create("A",{props:{href:this.values[n].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}));this.oPopup=new BX.PopupWindow(this.id,this.pInput,{autoHide:!0,offsetTop:1,offsetLeft:0,lightShadow:!0,closeByEsc:!0,content:i}),BX.addCustomEvent(this.oPopup,"onPopupClose",BX.proxy(this.ClosePopup,this))}this.oPopup.show(),this.pInput.select(),this.bShowed=!0,BX.onCustomEvent(this,"onInputPopupShow",[this])}},ClosePopup:function(t){this.bShowed=!1,""==this.pInput.value&&this.OnChange(),BX.onCustomEvent(this,"onInputPopupClose",[this]),!0===t&&this.oPopup.close()},OnChange:function(){var t=this.pInput.value;this.bValues&&(""==this.pInput.value||this.pInput.value==this.defaultValue?(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName,t=""):this.pInput.className=""),isNaN(parseInt(this.curInd))||!1!==this.curInd&&t!=this.values[this.curInd].NAME?this.curInd=!1:this.curInd=parseInt(this.curInd),BX.onCustomEvent(this,"onInputPopupChanged",[this,this.curInd,t]),this.handler&&"function"==typeof this.handler&&this.handler({ind:this.curInd,value:t})},Set:function(t,e,i){this.curInd=t,!1!==this.curInd?this.pInput.value=this.values[this.curInd].NAME:this.pInput.value=e,!1!==i&&this.OnChange()},Get:function(t){var e=!1;return void 0===t&&(t=this.curInd),!1!==t&&this.values[t]&&(e=this.values[t].ID),e},GetIndex:function(t){for(var e=0,i=this.values.length;e<i;e++)if(this.values[e].ID==t)return e;return!1},Deactivate:function(t){""!=this.pInput.value&&this.pInput.value!=this.defaultValue||(t?(this.pInput.value="",this.pInput.className=this.noMRclassName):this.oEC.bUseMR&&(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName)),this.pInput.disabled=t}};var e=-1,i=null}function n(t,o){if(!1===t){if(i&&i.length>0){for(var s=0;s<i.length;s++)i[s]();i=null,e=-1}}else null===i&&(i=[],e=-1,BX.defer(n)(!1)),t>e?(e=t,i=[o]):t==e&&i.push(o)}}(window);